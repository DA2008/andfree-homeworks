# Домашнее задание к занятию 4. Добавление голосового интерфейса
Взаимодествовать с нашим приложением мы будем с помощью голоса. На занятии мы уже научились отправлять запрос на распознавание голоса, получать результат распозвонвани и записывать его в поле, воспроизводить ответ при нажатии на кнопку. Предлагаем улучшить наше приложение, сделать некоторые функции атоматическими, уменьшить колличество действий для пользователя нашего приложения. 

## Задание 1
Автоматический запуск поиска с результатом распознавания.

Давайте запустим функцию `askWolfram` внутри `onActivityResult` автоматически, сразу после записи вопроса в текстовое поле.
```Kotlin
override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
   super.onActivityResult(requestCode, resultCode, data)
   if (requestCode == 1) {
       if (resultCode == RESULT_OK && data != null) {
           ...
           if (question != null) {
               findViewById<TextView>(R.id.question_input).text = question
               askWolfram(question)
           }
       }
   }
}
```


## Задание 2
Автоматический запуск чтения результата

Для этого нам надо дать доступ к нашему объекту TextToSpeech
функции `askWolfram`.
Для этого вынесем объявление переменной `val tts` на уровень класса. Все переменные, определенные на уровне класса доступны всем метода, в этом классе. 
```Kotlin
class MainActivity : AppCompatActivity() {

   lateinit var tts: TextToSpeech
   var speechRequest = 0

   override fun onCreate(savedInstanceState: Bundle?) {
    ...
    val answerOutput = findViewById<TextView>(R.id.answer_output)

    tts = TextToSpeech(this, TextToSpeech.OnInitListener {  })
    tts.language = Locale.US

    findViewById<FloatingActionButton>(R.id.read_answer).setOnClickListener {
    …
}
```

`lateinit` - значит, что мы определим значение позже - мы делаем это в методе `onCreate, tts = TextToSpeech(...)`

Теперь в `askWolfram`, когда мы получаем ответ, мы сразу можем запустить чтение вслух.

```Kotlin
fun askWolfram(question: String) {
                   ...
                   if (element is WAPlainText) {
                       Log.d("wolfram", element.text)
                       answerText.text = element.text
                      findViewById<FloatingActionButton>(R.id.read_answer).setOnClickListener            
                      {
                           val answer = findViewById<TextView>(R.id.answer_output).text.toString()
                           tts.speak(answer, TextToSpeech.QUEUE_ADD, null, speechRequest.toString())
                           speechRequest += 1
                       }
                    }
                  ...
}
```


Любые вопросы по решению задач задавайте в чате в Telegram.
